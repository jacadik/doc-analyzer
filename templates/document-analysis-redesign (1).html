<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Analysis - Document Analyzer</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- The CSS styles are the same as the main layout, excluded here for brevity -->
</head>
<body>
    <!-- Header and Sidebar would be here (same as main layout) -->

    <!-- Main Content -->
    <main class="main-content">
        <div class="d-flex flex-wrap justify-content-between align-items-center mb-4">
            <div>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/documents">Documents</a></li>
                        <li class="breadcrumb-item"><a href="/document/1">Contract_Template_2023.pdf</a></li>
                        <li class="breadcrumb-item active">Content Analysis</li>
                    </ol>
                </nav>
                <h1 class="h3 mb-0">Content Analysis</h1>
            </div>
            
            <div class="d-flex gap-2 mt-2 mt-md-0">
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle" type="button" id="optionsDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-gear me-1"></i> Options
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="optionsDropdown">
                        <li>
                            <a class="dropdown-item" href="/document/1/text">
                                <i class="bi bi-file-text me-2"></i> View Text
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="/document/1/paragraphs">
                                <i class="bi bi-paragraph me-2"></i> View Paragraphs
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="/document/1/variables">
                                <i class="bi bi-code-square me-2"></i> View Variables
                            </a>
                        </li>
                        <li><hr class="dropdown-divider"></li>
                        <li>
                            <a class="dropdown-item" href="/export/document/1">
                                <i class="bi bi-file-earmark-excel me-2"></i> Export to Excel
                            </a>
                        </li>
                    </ul>
                </div>
                
                <a href="/document/1" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left me-1"></i> Back
                </a>
            </div>
        </div>
        
        <div class="row">
            <!-- Analysis Options -->
            <div class="col-lg-4 col-md-12 mb-4">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="card-title">Analysis Options</h5>
                    </div>
                    <div class="card-body">
                        <form id="analysisOptionsForm" method="get" action="/document/1/analyze">
                            <div class="mb-3">
                                <label for="threshold" class="form-label d-flex justify-content-between">
                                    <span>Similarity Threshold</span>
                                    <span class="badge bg-primary" id="thresholdValue">0.8</span>
                                </label>
                                <div class="input-group">
                                    <input type="range" class="form-range" id="thresholdRange" min="0.5" max="1" step="0.05" value="0.8">
                                </div>
                                <div class="form-text">
                                    Higher values require more similarity between paragraphs.
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-arrow-repeat me-1"></i> Reanalyze
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Analysis Guide -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">Analysis Guide</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <h6 class="d-flex align-items-center">
                                <i class="bi bi-info-circle text-primary me-2"></i> Understanding the Analysis
                            </h6>
                            <ul class="list-unstyled ps-4">
                                <li class="mb-2">
                                    <span class="fw-medium">Duplicate Paragraphs</span>
                                    <p class="text-muted small mb-0">Identical paragraphs that appear multiple times within this document.</p>
                                </li>
                                <li class="mb-2">
                                    <span class="fw-medium">Similar Paragraphs</span>
                                    <p class="text-muted small mb-0">Paragraphs that are not identical but have similar content above the threshold.</p>
                                </li>
                                <li class="mb-2">
                                    <span class="fw-medium">Common Phrases</span>
                                    <p class="text-muted small mb-0">Recurring text fragments that appear throughout the document.</p>
                                </li>
                            </ul>
                        </div>
                        
                        <div>
                            <h6 class="d-flex align-items-center">
                                <i class="bi bi-lightbulb text-warning me-2"></i> Tips
                            </h6>
                            <ul class="list-unstyled ps-4">
                                <li class="mb-2">Lower the threshold to find more similar paragraphs with minor differences.</li>
                                <li class="mb-2">Look for patterns in the similar content to identify template structures.</li>
                                <li class="mb-2">Pay attention to common phrases that might indicate standardized language.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Analysis Results -->
            <div class="col-lg-8 col-md-12">
                <!-- Duplicate Paragraphs -->
                <div class="card mb-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">
                            Duplicate Paragraphs
                        </h5>
                        <span class="badge bg-primary">3</span>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="duplicateAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="duplicateHeading1">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#duplicateCollapse1" aria-expanded="false" aria-controls="duplicateCollapse1">
                                        <div class="d-flex justify-content-between align-items-center w-100 me-3">
                                            <span>Duplicate Group #1</span>
                                            <span class="badge bg-secondary">2 occurrences</span>
                                        </div>
                                    </button>
                                </h2>
                                <div id="duplicateCollapse1" class="accordion-collapse collapse" aria-labelledby="duplicateHeading1" data-bs-parent="#duplicateAccordion">
                                    <div class="accordion-body">
                                        <div class="p-3 bg-light rounded">
                                            <p class="highlight-duplicate mb-0">
                                                IN WITNESS WHEREOF, the parties hereto have executed this Agreement as of the date first above written.
                                            </p>
                                        </div>
                                        
                                        <hr>
                                        
                                        <h6>Occurrences:</h6>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                <span>Position #15</span>
                                                <a href="#" class="btn btn-sm btn-outline-primary">View in Context</a>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                <span>Position #28</span>
                                                <a href="#" class="btn btn-sm btn-outline-primary">View in Context</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="duplicateHeading2">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#duplicateCollapse2" aria-expanded="false" aria-controls="duplicateCollapse2">
                                        <div class="d-flex justify-content-between align-items-center w-100 me-3">
                                            <span>Duplicate Group #2</span>
                                            <span class="badge bg-secondary">3 occurrences</span>
                                        </div>
                                    </button>
                                </h2>
                                <div id="duplicateCollapse2" class="accordion-collapse collapse" aria-labelledby="duplicateHeading2" data-bs-parent="#duplicateAccordion">
                                    <div class="accordion-body">
                                        <div class="p-3 bg-light rounded">
                                            <p class="highlight-duplicate mb-0">
                                                The Service Provider shall maintain all records related to this Agreement for a period of [Record Retention Period] following the termination of this Agreement.
                                            </p>
                                        </div>
                                        
                                        <hr>
                                        
                                        <h6>Occurrences:</h6>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                <span>Position #10</span>
                                                <a href="#" class="btn btn-sm btn-outline-primary">View in Context</a>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                <span>Position #18</span>
                                                <a href="#" class="btn btn-sm btn-outline-primary">View in Context</a>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                <span>Position #25</span>
                                                <a href="#" class="btn btn-sm btn-outline-primary">View in Context</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="duplicateHeading3">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#duplicateCollapse3" aria-expanded="false" aria-controls="duplicateCollapse3">
                                        <div class="d-flex justify-content-between align-items-center w-100 me-3">
                                            <span>Duplicate Group #3</span>
                                            <span class="badge bg-secondary">2 occurrences</span>
                                        </div>
                                    </button>
                                </h2>
                                <div id="duplicateCollapse3" class="accordion-collapse collapse" aria-labelledby="duplicateHeading3" data-bs-parent="#duplicateAccordion">
                                    <div class="accordion-body">
                                        <!-- Content would go here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Similar Paragraphs -->
                <div class="card mb-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">
                            Similar Paragraphs
                        </h5>
                        <span class="badge bg-primary">4</span>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="similarAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="similarHeading1">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#similarCollapse1" aria-expanded="false" aria-controls="similarCollapse1">
                                        <div class="d-flex justify-content-between align-items-center w-100 me-3">
                                            <span>Similar Pair #1</span>
                                            <span class="badge bg-info text-dark">82% similar</span>
                                        </div>
                                    </button>
                                </h2>
                                <div id="similarCollapse1" class="accordion-collapse collapse" aria-labelledby="similarHeading1" data-bs-parent="#similarAccordion">
                                    <div class="accordion-body">
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="card h-100">
                                                    <div class="card-header py-2">
                                                        <h6 class="card-title mb-0">Paragraph #8</h6>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="highlight-similar p-2 rounded">
                                                            The Customer shall pay the Service Provider the sum of <<contract_value>> for the Services rendered under this Agreement.
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="card h-100">
                                                    <div class="card-header py-2">
                                                        <h6 class="card-title mb-0">Paragraph #22</h6>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="highlight-similar p-2 rounded">
                                                            The Client shall pay the Service Provider the total amount of <<contract_value>> for the Services provided under this Agreement.
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-3">
                                            <button class="btn btn-sm btn-outline-primary compare-btn" 
                                                    data-text1="The Customer shall pay the Service Provider the sum of <<contract_value>> for the Services rendered under this Agreement." 
                                                    data-text2="The Client shall pay the Service Provider the total amount of <<contract_value>> for the Services provided under this Agreement.">
                                                <i class="bi bi-arrows me-1"></i> Compare Differences
                                            </button>
                                        </div>
                                        
                                        <div class="diff-result mt-3 p-3 bg-light rounded" style="display: none;">
                                            <!-- Diff result will be shown here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="similarHeading2">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#similarCollapse2" aria-expanded="false" aria-controls="similarCollapse2">
                                        <div class="d-flex justify-content-between align-items-center w-100 me-3">
                                            <span>Similar Pair #2</span>
                                            <span class="badge bg-info text-dark">78% similar</span>
                                        </div>
                                    </button>
                                </h2>
                                <div id="similarCollapse2" class="accordion-collapse collapse" aria-labelledby="similarHeading2" data-bs-parent="#similarAccordion">
                                    <div class="accordion-body">
                                        <!-- Content would go here -->
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="similarHeading3">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#similarCollapse3" aria-expanded="false" aria-controls="similarCollapse3">
                                        <div class="d-flex justify-content-between align-items-center w-100 me-3">
                                            <span>Similar Pair #3</span>
                                            <span class="badge bg-info text-dark">75% similar</span>
                                        </div>
                                    </button>
                                </h2>
                                <div id="similarCollapse3" class="accordion-collapse collapse" aria-labelledby="similarHeading3" data-bs-parent="#similarAccordion">
                                    <div class="accordion-body">
                                        <!-- Content would go here -->
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="similarHeading4">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#similarCollapse4" aria-expanded="false" aria-controls="similarCollapse4">
                                        <div class="d-flex justify-content-between align-items-center w-100 me-3">
                                            <span>Similar Pair #4</span>
                                            <span class="badge bg-info text-dark">72% similar</span>
                                        </div>
                                    </button>
                                </h2>
                                <div id="similarCollapse4" class="accordion-collapse collapse" aria-labelledby="similarHeading4" data-bs-parent="#similarAccordion">
                                    <div class="accordion-body">
                                        <!-- Content would go here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Common Phrases -->
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">
                            Common Phrases
                        </h5>
                        <span class="badge bg-primary">5</span>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th scope="col" width="5%">#</th>
                                        <th scope="col" width="80%">Phrase</th>
                                        <th scope="col" width="15%" class="text-center">Occurrences</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>"the Service Provider shall provide the Services in accordance with"</td>
                                        <td class="text-center">4</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>"this Agreement may be terminated by either party with written notice"</td>
                                        <td class="text-center">3</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>"shall remain in effect for a period of <<agreement_duration>>"</td>
                                        <td class="text-center">3</td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>"all notices required under this Agreement shall be in writing"</td>
                                        <td class="text-center">2</td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td>"the laws of the state of <<state>> shall govern this Agreement"</td>
                                        <td class="text-center">2</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Comparison Modal -->
    <div class="modal fade" id="comparisonModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Paragraph Comparison</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="diffResult">
                        <div class="diff-container">
                            <div class="diff diff-left p-3 rounded">
                                <span class="diff-same">The</span> 
                                <span class="diff-removed">Customer</span> 
                                <span class="diff-same">shall pay the Service Provider the</span> 
                                <span class="diff-removed">sum</span> 
                                <span class="diff-same">of &lt;&lt;contract_value&gt;&gt; for the Services</span> 
                                <span class="diff-removed">rendered</span> 
                                <span class="diff-same">under this Agreement.</span>
                            </div>
                            <div class="diff diff-right p-3 rounded">
                                <span class="diff-same">The</span> 
                                <span class="diff-added">Client</span> 
                                <span class="diff-same">shall pay the Service Provider the</span> 
                                <span class="diff-added">total amount</span> 
                                <span class="diff-same">of &lt;&lt;contract_value&gt;&gt; for the Services</span> 
                                <span class="diff-added">provided</span> 
                                <span class="diff-same">under this Agreement.</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer would be here (same as main layout) -->

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Threshold range slider
            const thresholdRange = document.getElementById('thresholdRange');
            const thresholdValue = document.getElementById('thresholdValue');
            
            thresholdRange.addEventListener('input', function() {
                thresholdValue.textContent = thresholdRange.value;
            });
            
            // Compare text differences
            const compareButtons = document.querySelectorAll('.compare-btn');
            const comparisonModal = new bootstrap.Modal(document.getElementById('comparisonModal'));
            
            compareButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const text1 = this.getAttribute('data-text1');
                    const text2 = this.getAttribute('data-text2');
                    
                    // Find the closest diff result container
                    const diffContainer = this.closest('.accordion-body').querySelector('.diff-result');
                    
                    // Clone the diff result from the modal for this specific comparison
                    const diffResult = document.getElementById('diffResult').cloneNode(true);
                    
                    // Show differences in the container
                    diffContainer.innerHTML = '';
                    diffContainer.appendChild(diffResult);
                    diffContainer.style.display = 'block';
                    
                    // Also show in modal for a larger view
                    comparisonModal.show();
                });
            });
        });
    </script>
</body>
</html>